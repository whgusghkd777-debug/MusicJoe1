<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" layout:decorate="~{layout}">
<section layout:fragment="content">
    <div class="card" style="background: white; border-radius: 24px; padding: 40px; box-shadow: 0 4px 20px rgba(0,0,0,0.05);">
        <h1 th:text="${music.title}" style="font-weight: 800; font-size: 2rem;"></h1>
        <p style="color: #86868B;">アーティスト: <span th:text="${music.artist}"></span></p>
        
        <div th:if="${embedUrl}" style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 15px; background: #000; margin: 20px 0;">
            <iframe th:src="${embedUrl}" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;" allowfullscreen></iframe>
        </div>

        <div th:if="${music.filePath}" style="margin: 20px 0;">
            <audio controls controlsList="nodownload" style="width: 100%;">
                <source th:src="@{|/files/${music.filePath}|}" type="audio/mpeg">
                お使いのブラウザはオーディオ再生に対応していません。
            </audio>
        </div>

        <a th:href="@{|/music/vote/${music.id}|}" style="display:inline-block; background:#FFF0F0; color:#FF3B30; padding:12px 24px; border-radius:15px; text-decoration:none; font-weight:600;">
            ❤️ いいね <span th:text="${#lists.size(music.voter)}"></span>
        </a>

        <div style="margin-top: 40px; border-top: 1px solid #eee; padding-top: 30px;">
            <h4 style="font-weight:700;">コメント (<span th:text="${#lists.size(music.answerList)}"></span>)</h4>
            <div th:each="answer : ${music.answerList}" style="padding:15px 0; border-bottom:1px solid #f9f9f9;">
                <p th:text="${answer.content}" style="margin-bottom:5px;"></p>
                <small style="color:#86868B;" th:text="${answer.author.username}"></small>
            </div>
            <form th:action="@{|/answer/create/${music.id}|}" method="post" style="margin-top:20px;">
                <textarea name="content" rows="3" style="width:100%; border-radius:12px; border:1px solid #ddd; padding:15px;" placeholder="コメントを残してください..."></textarea>
                <button type="submit" style="margin-top:10px; background:#007AFF; color:white; border:none; padding:10px 20px; border-radius:10px;">投稿</button>
            </form>
        </div>
    </div>
</section>
</html>